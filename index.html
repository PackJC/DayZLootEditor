<!DOCTYPE html>
<html lang="eng" class="">
  <head>
    <meta charset="UTF-8">
    <link href="./node_modules/bootstrap/dist/css/bootstrap.css" rel="stylesheet" crossorigin="anonymous">
    <link href="./styles.css" rel="stylesheet">
    <title>XML Editor : DayZ Standalone</title>
  </head>
  <body class="">
  <nav class="navbar navbar-expand navbar-light border-dark border-bottom bg-dark" style="background-color: rgba(0, 0, 0, 0.2);">
    <ul class="navbar-nav p-0">
      <li class="nav-item align-self-center p-1">
        <img src="./media/DayZLogo.png" class="img-fluid" alt="DayZ Logo"/>
      </li>
      <li class="nav-item p-3 align-self-center active">
        <button  class="nav-link btn btn-warning" id="getFile">Import XML Files</button>
      </li>
      <li class="nav-item p-3 align-self-center">
        <a class="nav-link btn btn-warning disabled save-btn" id="saveFile">Save</a>
      </li>
      <li class="nav-item p-3 align-self-center">
        <a class="nav-link  btn btn-warning" id="help">Help</a>
      </li>
    </ul>
  </nav>

  <table class="table table-striped table-responsive" id="myTable">
    <thead>
    <tr class="justify-content-center">
      <th title="">Name</th>
      <th title="Amount of the item allowed on the entire map">Nominal</th>
      <th title="Lifetime of an item once it is spawned in seconds">Lifetime</th>
      <th title="Amount of time that will need to pass before an item is allowed to spawn again">Restock</th>
      <th title="Amount of an item that will spawn on the map">Min</th>
      <th title="Minimum quantity of consumable within the item">QuantMin</th>
      <th title="Maximum quantity of consumable within the item">QuantMax</th>
      <th title="Determines the spawn chance of an item">Cost</th>
      <th title="Count for this weapon will include inventory of vehicles towards Max">Count in Cargo</th>
      <th title="Count for this weapon will include inventory of containers that can be moved/placed/built by a player (barrels/sea chest/tent/backpack/protector case) towards Max">Count in Hoarder</th>
      <th title="Count for this weapon will include items in/on map towards Max.">Count in Map</th>
      <th title="Count for this weapon will include Player Inventory and Player Hands towards weapon Max">Count in Player</th>
      <th title="Used only to mark player craftable items">Crafted</th>
      <th title="Dynamic Event Loot, the items and weapons that usually spawn around Helicopter Crash Sites">Deloot</th>
      <th title="How and where the item spawns">Category</th>
      <th title="Group in which area an item will spawn">Usage</th>
      <th title="How and where the item spawns">Value</th>
    </tr>
    </thead>
    <tbody id="myTBody">


    </tbody>
  </table>
  </body>
  <footer class="bg-dark text-center text-warning fixed-bottom border-dark border-top">
    <div class="text-center" style="background-color: rgba(0, 0, 0, 0.2);">
      Â© 2022 PackJC Version 0.61
    </div>
  </footer>
</html>

<script src="./renderer.js">

</script>
<script>
  const {ipcRenderer} = require("electron");
  ipcRenderer.on("receiveDataReply",(event,data)=>{
    //console.log("successful file upload")
    //document.getElementById('importButton').innerHTML = data                       '<td contenteditable>' + element.category[0]?.$.name  + '</td>' +
    data.types.type.forEach(element =>
    document.getElementById( 'myTBody' ).innerHTML +=
                    '<tr id = "row">' +
                      '<td>' + element.$.name.toString() + '</td>' +
                      '<td contenteditable>' + element.nominal + '</td>' +
                      '<td contenteditable>' + element.lifetime + '</td>' +
                      '<td contenteditable>' + element.restock + '</td>' +
                      '<td contenteditable>' + element.min + '</td>' +
                      '<td contenteditable>' + element.quantmin + '</td>' +
                      '<td contenteditable>' + element.quantmax + '</td>' +
                      '<td contenteditable>' + element.cost + '</td>' +
                      '<td contenteditable>' + element.flags[0].$.count_in_cargo + '</td>' +
                      '<td contenteditable>' + element.flags[0].$.count_in_hoarder + '</td>' +
                      '<td contenteditable>' + element.flags[0].$.count_in_map + '</td>' +
                      '<td contenteditable>' + element.flags[0].$.count_in_player + '</td>' +
                      '<td contenteditable>' + element.flags[0].$.crafted + '</td>' +
                      '<td contenteditable>' + element.flags[0].$.deloot + '</td>' +
                      '<td contenteditable>' + element.category?.[0].$.name  + '</td>' +
                      //'<td contenteditable>' + element.usage?.[0].$.name  + element.usage?.[1].$.name  + element.usage?.[2].$.name  +'</td>' +
                     // '<td contenteditable>' + element.value?.[0].$.name  + element.value?.[1].$.name  + element.value?.[2].$.name  +'</td>' +
                    '</tr>'

  );
    document.querySelector('.save-btn').classList.remove('disabled')
  })

  ipcRenderer.on("updateImportButton",(event,data)=>{
    //Change import button to local file path
    document.getElementById('getFile').innerHTML = data.toString()
  })
  document.getElementById("getFile").addEventListener("click",getFileFunction);
  document.getElementById("saveFile").addEventListener("click", saveFileFunction);

  function getFileFunction(){
    ipcRenderer.send("getFileEvent")
  }
  function saveFileFunction(){
    ipcRenderer.send("saveFileEvent")
  }
  document.getElementById("help").addEventListener("click",getHelp);
  function getHelp(){
    window.location.href = "help.html";
  }
</script>
